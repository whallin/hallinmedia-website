---
import { getCollection } from "astro:content";
import IconPhGavelDuotone from "../../../components/icons/PhGavelDuotone.astro";
import LegalCategorySection from "../../../components/legal/LegalCategorySection.astro";
import MainLayout from "../../../layouts/MainLayout.astro";

const allLegalDocs = (await getCollection("legalSvCollection")).sort(
  (a, b) => new Date(b.data.publishedDate).getTime() - new Date(a.data.publishedDate).getTime()
);

const groupedDocs = allLegalDocs.reduce((acc: Record<string, typeof allLegalDocs>, doc) => {
  const category = doc.data.documentType;
  if (!acc[category]) {
    acc[category] = [];
  }
  acc[category].push(doc);
  return acc;
}, {});
---

<MainLayout title="Juridik">
  <main class="font-serif selection:bg-red-300 selection:text-red-800">
    <header class="flex flex-col-reverse justify-between gap-4 sm:flex-row sm:items-center">
      <h1 class="max-w-md text-4xl font-light text-stone-900 italic">Juridik</h1>
      <IconPhGavelDuotone
        class="-motion-rotate-loop-16 flip motion-ease motion-duration-2000 h-8 w-8 origin-bottom-left text-red-500 sm:h-12 sm:w-12"
      />
    </header>
    <article class="mt-12 flex flex-col gap-4 text-sm font-light text-stone-700">
      <p>
        Ibland kan pappersarbete, särskilt juridiska dokument, komma i vägen för det roliga. Jag ser
        till att alla nödvändiga dokument och villkor är förberedda för dig och ditt företag när vi
        arbetar tillsammans. Du är mer än välkommen att titta runt och se vilka villkor och policyer
        som finns för dig.
      </p>
      <p>
        Om du har några frågor om mina juridiska dokument är du välkommen att <a
          href="mailto:william@hallin.media?subject=En juridisk fråga..."
          class="text-red-500 underline decoration-dashed decoration-from-font underline-offset-4 hover:bg-red-500 hover:text-stone-50 hover:no-underline active:opacity-50"
          >mejla mig</a
        >.
      </p>

      <div class="mt-6 space-y-8">
        {
          Object.entries(groupedDocs).map(([category, docs]) => (
            <LegalCategorySection category={category} docs={docs} />
          ))
        }
      </div>
    </article>
  </main>
</MainLayout>
