---
import PhBuildingsDuotone from "../../components/icons/PhBuildingsDuotone.astro";
import PhCalendarDuotone from "../../components/icons/PhCalendarDuotone.astro";
import PhClockCounterClockwiseDuotone from "../../components/icons/PhClockCounterClockwiseDuotone.astro";
import PhEnvelopeDuotone from "../../components/icons/PhEnvelopeDuotone.astro";
import PhHeartDuotone from "../../components/icons/PhHeartDuotone.astro";
import PhSparkleDuotone from "../../components/icons/PhSparkleDuotone.astro";

const translations = {
  en: {
    audience: "Audience",
    jurisdiction: "Jurisdiction",
    effective_date: "Effective date",
    last_edited: "Last edited",
    compliance: "Compliance",
    metadata_title: "Document Metadata",
    details_label: "Document details",
    compliance_label: "Compliance information",
    version_label: "Document version",
    audience_type: "Audience type",
    jurisdiction_label: "Jurisdiction",
    effective_date_label: "Effective date",
    last_edited_label: "Last edited date",
  },
  sv: {
    audience: "Målgrupp",
    jurisdiction: "Jurisdiktion",
    effective_date: "Effektivt datum",
    last_edited: "Senast redigerad",
    compliance: "Regelkrav",
    metadata_title: "Dokumentmetadata",
    details_label: "Dokumentdetaljer",
    compliance_label: "Regelkravsinformation",
    version_label: "Dokumentversion",
    audience_type: "Målgruppstyp",
    jurisdiction_label: "Jurisdiktion",
    effective_date_label: "Effektivt datum",
    last_edited_label: "Senast redigerad datum",
  },
};

const { item, audienceColor } = Astro.props;
---

<article
  class="grid gap-6 rounded-lg border border-stone-200 p-6 font-mono text-sm text-stone-600"
  aria-labelledby="metadata-title"
>
  <h2 id="metadata-title" class="sr-only">{translations[Astro.currentLocale].metadata_title}</h2>
  <section
    class="grid gap-4 sm:grid-cols-2"
    aria-label={translations[Astro.currentLocale].details_label}
  >
    <div class="space-y-2">
      <div
        class={`flex items-center gap-2 ${audienceColor === "blue" ? "selection:bg-blue-300 selection:text-blue-800" : audienceColor === "pink" ? "selection:bg-pink-300 selection:text-pink-800" : "selection:bg-purple-300 selection:text-purple-800"}`}
        role="listitem"
      >
        <div class="flex items-center gap-2">
          <span
            class={audienceColor === "blue"
              ? "text-blue-500"
              : audienceColor === "pink"
                ? "text-pink-500"
                : "text-purple-500"}
            aria-hidden="true"
          >
            {
              item.data.audience === "B2B" ? (
                <PhEnvelopeDuotone class="h-4 w-4" />
              ) : item.data.audience === "B2C" ? (
                <PhHeartDuotone class="h-4 w-4" />
              ) : (
                <PhSparkleDuotone class="h-4 w-4" />
              )
            }
          </span>
          <p>
            <span class="sr-only">{translations[Astro.currentLocale].audience_type}: </span>
            {translations[Astro.currentLocale].audience}: {
              item.data.audience === "Both" || "Båda" ? "B2B + B2C" : item.data.audience
            }
          </p>
        </div>
      </div>
      {
        item.data.jurisdiction && (
          <div
            class="flex items-center gap-2 selection:bg-green-300 selection:text-green-800"
            role="listitem"
          >
            <div class="flex items-center gap-2">
              <PhBuildingsDuotone class="h-4 w-4 text-green-500" aria-hidden="true" />
              <p>
                <span class="sr-only">
                  {translations[Astro.currentLocale].jurisdiction_label}:{" "}
                </span>
                {translations[Astro.currentLocale].jurisdiction}: {item.data.jurisdiction}
              </p>
            </div>
          </div>
        )
      }
    </div>

    <div class="space-y-2 selection:bg-indigo-300 selection:text-indigo-800" role="list">
      <div class="flex items-center gap-2" role="listitem">
        <div class="flex items-center gap-2">
          <PhCalendarDuotone class="h-4 w-4 text-indigo-500" aria-hidden="true" />
          <p>
            <span class="sr-only">{translations[Astro.currentLocale].effective_date_label}: </span>
            {translations[Astro.currentLocale].effective_date}: {
              new Date(item.data.effectiveDate).toLocaleDateString()
            }
          </p>
        </div>
      </div>
      <div class="flex items-center gap-2" role="listitem">
        <div class="flex items-center gap-2">
          <PhClockCounterClockwiseDuotone class="h-4 w-4 text-indigo-500" aria-hidden="true" />
          <p>
            <span class="sr-only">{translations[Astro.currentLocale].last_edited_label}: </span>
            {translations[Astro.currentLocale].last_edited}: {
              new Date(item.data.lastEdited).toLocaleDateString()
            }
          </p>
        </div>
      </div>
    </div>
  </section>

  {
    item.data.compliance && item.data.compliance.length > 0 && (
      <footer
        class="border-t border-stone-200 pt-4 selection:bg-red-300 selection:text-red-800"
        aria-label={translations[Astro.currentLocale].compliance_label}
      >
        <div class="flex flex-col-reverse justify-between gap-4 sm:flex-row sm:items-center">
          <div>
            <h3 class="mb-2 text-xs font-medium text-stone-500" id="compliance-label">
              {translations[Astro.currentLocale].compliance}
            </h3>
            <ul class="flex flex-wrap gap-2" aria-labelledby="compliance-label">
              {item.data.compliance.map((compliance) => (
                <li class="rounded-full border border-stone-500 px-3 py-1 text-xs transition hover:-translate-y-1 hover:border-red-500 hover:text-red-700 active:-translate-y-1 active:border-red-500 active:text-red-700">
                  {compliance}
                </li>
              ))}
            </ul>
          </div>
          <span
            class="w-fit rounded-full border border-stone-500 px-3 py-1 text-xs"
            aria-label={`${translations[Astro.currentLocale].version_label} ${item.data.version}`}
          >
            v{item.data.version}
          </span>
        </div>
      </footer>
    )
  }
</article>
