---
import Footer from "../components/layout/Footer.astro";
import Navbar from "../components/layout/Navbar.astro";
import SiteHead from "../components/layout/SiteHead.astro";
import "../styles/global.css";

interface Props {
  title: string;
  description?: string;
  article?: boolean;
  faqData?: any;
  datePublished?: string;
  dateModified?: string;
}

function truncateDescription(text: string, maxLength: number): string {
  if (text.length <= maxLength) return text;

  const truncated = text.slice(0, maxLength);
  const lastBoundary = Math.max(
    truncated.lastIndexOf("."),
    truncated.lastIndexOf("!"),
    truncated.lastIndexOf("?")
  );

  return lastBoundary > 0 ? text.slice(0, lastBoundary + 1) : truncated;
}

const { title, description = "", article, faqData, datePublished, dateModified } = Astro.props;
const truncatedDescription = truncateDescription(description, 160);

const translations = {
  en: {
    skip_to_main_content: "Skip to main content",
  },
  sv: {
    skip_to_main_content: "Hoppa till huvud inneh√•ll",
  },
};
---

<!doctype html>
<html lang={Astro.currentLocale}>
  <head>
    <SiteHead
      title={title}
      description={truncatedDescription}
      article={article}
      faqData={faqData}
      datePublished={datePublished}
      dateModified={dateModified}
    />
  </head>

  <body class="mx-8 my-12 max-w-2xl bg-amber-50 md:mx-auto">
    <a href="#main" class="sr-only focus:not-sr-only">
      <span class="z-10 rounded bg-red-100 px-4 py-2 font-bold text-red-900 shadow-md">
        {translations[Astro.currentLocale].skip_to_main_content}
      </span>
    </a>
    <Navbar />
    <main id="main" tabindex="-1">
      <slot />
    </main>
    <Footer />
  </body>
</html>
